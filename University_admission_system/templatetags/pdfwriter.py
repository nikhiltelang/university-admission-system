from fpdf import  FPDF
from University_admission_system.templatetags.CassandraOperation import CassandraManagement
import webbrowser


class pdf:
    def __init__(self,id):
        self.id = id
        self.cdb = CassandraManagement()

    def pdfwriter(self):
        get_info = self.cdb.student_info(self.id)
        personoal_info = get_info[0]
        religion_info = get_info[1]
        caste_info = get_info[2]
        income_info = get_info[3]
        domicile_info = get_info[4]
        p_address = get_info[5]
        c_address = get_info[6]
        past_edu = get_info[7]
        apply_info = get_info[8]

        print(personoal_info[0][0])
        print(religion_info[0][0])
        print(caste_info[0][0])
        print(income_info[0][0])
        print(domicile_info[0][0])
        print(p_address[0][0])
        print(c_address[0][0])
        print(past_edu[0][0])
        print(apply_info[0][0])

        pdf = FPDF()
        pdf.add_page()
        pdf.set_font("Times",'B', size=17)
        pdf.set_fill_color(123,131,254)
        pdf.rect(10,10,190,20,style='DF')
        pdf.cell(190, 20, "University Admission System", ln=1, align='c')
        pdf.set_font("Times", '', size=12)
        pdf.cell(190, 10, "Application Form", ln=1, align='c')

        pdf.rect(10, 50, 190, 80, style='D')
        pdf.cell(190, 10,"Personal Details", ln=1, align='c',border=1)
        pdf.cell(100, 10, "Applicant FullName :" )
        pdf.cell(80, 10, str(personoal_info[0][3]), ln=1, align='c')
        pdf.cell(100, 10, "Date Of Birth : ")
        pdf.cell(80, 10, str(personoal_info[0][4]), ln=1, align='c')
        pdf.cell(100, 10, "Email")
        pdf.cell(80, 10, str(personoal_info[0][5]), ln=1, align='c')
        pdf.cell(100, 10, "Gender")
        pdf.cell(80, 10, str(personoal_info[0][6]), ln=1, align='c')
        pdf.cell(100, 10, "marital Status")
        pdf.cell(80, 10, str(personoal_info[0][7]), ln=1, align='c')
        pdf.cell(100, 10, "Mobile Number")
        pdf.cell(80, 10, str(personoal_info[0][8]), ln=1, align='c')
        pdf.cell(100, 10, "Parent Mobile Number")
        pdf.cell(80, 10, str(personoal_info[0][10]), ln=1, align='c')
        pdf.cell(100, 10, "Age")
        pdf.cell(80, 10, str(personoal_info[0][2]), ln=1, align='c')
        pdf.cell(100, 10, "", ln=1, align='c')

        pdf.rect(10, 140, 190, 20, style='D')
        pdf.cell(190, 10, "Religion Details", ln=1, align='c',border=1)
        pdf.cell(100, 10, "Religion")
        pdf.cell(80, 10, str(religion_info[0][1]), ln=1, align='c')
        pdf.cell(190, 10, "", ln=1, align='c')

        pdf.rect(10, 180, 190, 80, style='D')
        pdf.cell(190, 10, "Caste Details", ln=1, align='c', border=1)
        pdf.cell(100, 10, "Caste")
        pdf.cell(80, 10, str(caste_info[0][2]), ln=1, align='c')
        pdf.cell(100, 10, "Caste Category")
        pdf.cell(80, 10, str(caste_info[0][5]), ln=1, align='c')
        pdf.cell(100, 10, "Do You Have Caste Certificate ?")
        pdf.cell(80, 10, str(caste_info[0][6]), ln=1, align='c')
        pdf.cell(100, 10, "Applicant Name")
        pdf.cell(80, 10, str(caste_info[0][1]), ln=1, align='c')
        pdf.cell(100, 10, "Caste Certificate Number")
        pdf.cell(80, 10, str(caste_info[0][3]), ln=1, align='c')
        pdf.cell(100, 10, "Caste Issuing Authority")
        pdf.cell(80, 10, str(caste_info[0][7]), ln=1, align='c')
        pdf.cell(100, 10, "Issuing Date")
        pdf.cell(80, 10, str(caste_info[0][8]), ln=1, align='c')
        pdf.cell(100, 10, "Issuing District")
        pdf.cell(80, 10, str(caste_info[0][9]), ln=1, align='c')
        pdf.cell(190, 10, "", ln=1, align='c')

        pdf.add_page()
        pdf.set_font("Times", '', size=12)
        pdf.rect(10, 10, 190, 60, style='D')
        pdf.cell(190, 10, "Income Details", ln=1, align='c', border=1)
        pdf.cell(100, 10, "Do You Have Income Certificate")
        pdf.cell(80, 10, str(income_info[0][1]), ln=1, align='c')
        pdf.cell(100, 10, "Annual Income")
        pdf.cell(80, 10, str(income_info[0][2]), ln=1, align='c')
        pdf.cell(100, 10, "Income Certificate Number")
        pdf.cell(80, 10, str(income_info[0][3]), ln=1, align='c')
        pdf.cell(100, 10, "Issuing Authority")
        pdf.cell(80, 10, str(income_info[0][5]), ln=1, align='c')
        pdf.cell(100, 10, "Issuing Date")
        pdf.cell(80, 10, str(income_info[0][6]), ln=1, align='c')
        pdf.cell(190, 10, "", ln=1, align='c')

        pdf.rect(10, 80, 190, 80, style='D')
        pdf.cell(190, 10, "Domicile Details", ln=1, align='c', border=1)
        pdf.cell(100, 10, "Are you Domicile of Maharashtra ?")
        pdf.cell(80, 10, str(domicile_info[0][2]), ln=1, align='c')
        pdf.cell(100, 10, "Do you have Domicile Certificate ?")
        pdf.cell(80, 10, str(domicile_info[0][3]), ln=1, align='c')
        pdf.cell(100, 10, "Relationship Type")
        pdf.cell(80, 10, str(domicile_info[0][8]), ln=1, align='c')
        pdf.cell(100, 10, "Domicile Certificate No")
        pdf.cell(80, 10, str(domicile_info[0][4]), ln=1, align='c')
        pdf.cell(100, 10, "Applicant Name")
        pdf.cell(80, 10, str(domicile_info[0][1]), ln=1, align='c')
        pdf.cell(100, 10, "Issuing Authority")
        pdf.cell(80, 10, str(domicile_info[0][6]), ln=1, align='c')
        pdf.cell(100, 10, "Issuing Date")
        pdf.cell(80, 10, str(domicile_info[0][7]), ln=1, align='c')
        pdf.cell(190, 10, "", ln=1, align='c')

        pdf.rect(10, 170, 190, 70, style='D')
        pdf.cell(190, 10, "Permanent Address Details", ln=1, align='c', border=1)
        pdf.cell(100, 10, "Address")
        pdf.cell(80, 10, str(p_address[0][1]), ln=1, align='c')
        pdf.cell(100, 10, "State")
        pdf.cell(80, 10, str(p_address[0][4]), ln=1, align='c')
        pdf.cell(100, 10, "District")
        pdf.cell(80, 10, str(p_address[0][2]), ln=1, align='c')
        pdf.cell(100, 10, "Taluka")
        pdf.cell(80, 10, str(p_address[0][5]), ln=1, align='c')
        pdf.cell(100, 10, "Village")
        pdf.cell(80, 10, str(p_address[0][6]), ln=1, align='c')
        pdf.cell(100, 10, "Pincode")
        pdf.cell(80, 10, str(p_address[0][3]), ln=1, align='c')
        pdf.cell(190, 10, "", ln=1, align='c')

        pdf.add_page()
        pdf.set_font("Times", '', size=12)
        pdf.rect(10, 10, 190, 70, style='D')
        pdf.cell(190, 10, "Correspondence Address Details", ln=1, align='c', border=1)
        pdf.cell(100, 10, "Address")
        pdf.cell(80, 10, str(c_address[0][1]), ln=1, align='c')
        pdf.cell(100, 10, "State")
        pdf.cell(80, 10, str(c_address[0][4]), ln=1, align='c')
        pdf.cell(100, 10, "District")
        pdf.cell(80, 10, str(c_address[0][2]), ln=1, align='c')
        pdf.cell(100, 10, "Taluka")
        pdf.cell(80, 10, str(c_address[0][5]), ln=1, align='c')
        pdf.cell(100, 10, "Village")
        pdf.cell(80, 10, str(c_address[0][6]), ln=1, align='c')
        pdf.cell(100, 10, "Pincode")
        pdf.cell(80, 10, str(c_address[0][3]), ln=1, align='c')
        pdf.cell(190, 10, "", ln=1, align='c')

        pdf.rect(10, 90, 190, 160, style='D')
        pdf.cell(190, 10, "Past Education Details", ln=1, align='c', border=1)
        pdf.cell(100, 10, "Qualification Level")
        pdf.cell(80, 10, str(past_edu[0][13]), ln=1, align='c')
        pdf.cell(100, 10, "Stream")
        pdf.cell(80, 10, str(past_edu[0][16]), ln=1, align='c')
        pdf.cell(100, 10, "Completed")
        pdf.cell(80, 10, str(past_edu[0][4]), ln=1, align='c')
        pdf.cell(100, 10, "Institute State")
        pdf.cell(80, 10, str(past_edu[0][7]), ln=1, align='c')
        pdf.cell(100, 10, "Institute District")
        pdf.cell(80, 10, str(past_edu[0][6]), ln=1, align='c')
        pdf.cell(100, 10, "Institute Taluka")
        pdf.cell(80, 10, str(past_edu[0][8]), ln=1, align='c')
        pdf.cell(100, 10, "College Name")
        pdf.cell(80, 10, str(past_edu[0][15]), ln=1, align='c')
        pdf.cell(100, 10, "Course")
        pdf.cell(80, 10, str(past_edu[0][5]), ln=1, align='c')
        pdf.cell(100, 10, "Board")
        pdf.cell(80, 10, str(past_edu[0][3]), ln=1, align='c')
        pdf.cell(100, 10, "Mode")
        pdf.cell(80, 10, str(past_edu[0][10]), ln=1, align='c')
        pdf.cell(100, 10, "Admission Year")
        pdf.cell(80, 10, str(past_edu[0][1]), ln=1, align='c')
        pdf.cell(100, 10, "Passing Year")
        pdf.cell(80, 10, str(past_edu[0][11]), ln=1, align='c')
        pdf.cell(100, 10, "Result")
        pdf.cell(80, 10, str(past_edu[0][14]), ln=1, align='c')
        pdf.cell(100, 10, "Percentage")
        pdf.cell(80, 10, str(past_edu[0][12]), ln=1, align='c')
        pdf.cell(100, 10, "Attempts")
        pdf.cell(80, 10, str(past_edu[0][2]), ln=1, align='c')
        pdf.cell(190, 10, "", ln=1, align='c')

        pdf.add_page()
        pdf.set_font("Times", '', size=12)
        pdf.rect(10, 10, 190, 90, style='D')
        pdf.cell(190, 10, "Applying Details", ln=1, align='c', border=1)
        pdf.cell(100, 10, "Course Name")
        pdf.cell(80, 10, str(apply_info[0][4]), ln=1, align='c')
        pdf.cell(100, 10, "Admission Type")
        pdf.cell(80, 10, str(apply_info[0][1]), ln=1, align='c')
        pdf.cell(100, 10, "CET / Merit Percentage / CLAT Score")
        pdf.cell(80, 10, str(apply_info[0][3]), ln=1, align='c')
        pdf.cell(100, 10, "Application Admission ID/CAP ID/CLAT Admit Card No")
        pdf.cell(80, 10, str(apply_info[0][2]), ln=1, align='c')
        pdf.cell(100, 10, "Is Admission Through Open Or Reserved Category ?")
        pdf.cell(80, 10, str(apply_info[0][2]), ln=1, align='c')
        pdf.cell(100, 10, "Gap Years")
        pdf.cell(80, 10, str(apply_info[0][5]), ln=1, align='c')
        pdf.cell(100, 10, "Mode")
        pdf.cell(80, 10, str(apply_info[0][6]), ln=1, align='c')
        pdf.cell(100, 10, "Reserved Category")
        pdf.cell(80, 10, str(apply_info[0][7]), ln=1, align='c')

        webbrowser.open('Nikhil.pdf')
        return pdf.output("Nikhil.pdf")




